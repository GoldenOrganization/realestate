<!DOCTYPE html>
<html class='no-js' lang='en'>
  <head>
    <meta charset='utf-8'>
    <meta content='IE=edge,chrome=1' http-equiv='X-UA-Compatible'>
    <title>HouseAdmin</title>
    <link href="assets/stylesheets/application-a07755f5.css" rel="stylesheet" type="text/css" />
    <link href="assets/images/favicon.ico" rel="icon" type="image/ico" />
    <link href="./css/fileinput.min.css" media="all" rel="stylesheet" type="text/css" />
	<link rel="stylesheet" href="./css/zeroModal.css" type="text/css" media="all">

  </head>
  <body class='main page'>
    <!-- Navbar -->
    <div class='navbar navbar-default' id='navbar'>
      <a class='navbar-brand' href='#'>
        <i class='icon-beer'></i>
        HouseAdmin
      </a>
      <ul class='nav navbar-nav pull-right'>

        <li class='dropdown user'>
          <a class='dropdown-toggle' data-toggle='dropdown' href='#'>
            <i class='icon-user'></i>
            <strong>Admin</strong>
            <b class='caret'></b>
          </a>

        </li>
      </ul>
    </div>
    <div id='wrapper'>
      <!-- Sidebar -->
      <section id='sidebar'>
        <i class='icon-align-justify icon-large' id='toggle'></i>
        <ul id='dock'>
          <li class='launcher'>
            <i class='icon-dashboard'></i>
            <a href="dashboard.html">Dashboard</a>
          </li>
          <li class='active launcher'>
            <i class='icon-file-text-alt'></i>
            <a href="forms.html">Houses</a>
          </li>
          <li class='launcher'>
            <i class='icon-table'></i>
            <a href="tables.html">News</a>
          </li>
          
        </ul>
        <div data-toggle='tooltip' id='beaker' title=''></div>
      </section>
      <!-- Tools -->
      <section id='tools'>
        <ul class='breadcrumb' id='breadcrumb'>
          <li class='title'>添加房产信息</li>
        </ul>
        <div id='toolbar'>
          
        </div>
      </section>
      <!-- Content -->
      <div id='content'>
        <div class='panel panel-default'>
          <div class='panel-heading'>
            <i class='icon-edit icon-large'></i>
            添加房产
          </div>
          <div class='panel-body'>
           
              <fieldset>
                <legend>房产信息</legend>
                <div class='form-group'>
                  <label class='control-label'>房产名称[中文]</label>
                  <input id="name_cn" name="name_cn" class='form-control' placeholder='Enter name' type='text'>
                </div>
                <div class='form-group'>
                  <label class='control-label'>realestate name[EN]</label>
                  <input id="name_en" class='form-control' placeholder='Enter name' type='text'>
                </div>
				<div class='form-group'>
                  <label class='control-label'>选择房产类型[至少必选一项]</label>
                  <br>
                  <div class='checkbox-inline'>
                    <input type='checkbox' value='公寓'>
                    公寓[apartment]
                  </div>
                  <div class='checkbox-inline'>
                    <input type='checkbox' value='现房'>
                    现房[completed]
                  </div>
                  <div class='checkbox-inline'>
                    <input type='checkbox' value='别墅'>
                    别墅[villa]
                  </div>
				  <div class='checkbox-inline'>
                    <input type='checkbox' value='楼花'>
                    楼花[uncompleted]
                  </div>
				  <div class='checkbox-inline'>
                    <input type='checkbox' value='联排别墅'>
                    联排别墅[united villa]
                  </div>
				  <div class='checkbox-inline'>
                    <input type='checkbox' value='已售'>
                    已售[sold]
                  </div>
                </div>
				<div class='form-group'>
                  <label class='control-label'>幻灯片显示简介[中文]</label>
                  <input id="sintro_cn" class='form-control' placeholder='幻灯片显示简介' type='text'>
                </div>
                <div class='form-group'>
                  <label class='control-label'>slide display[EN]</label>
                  <input id="sintro_en" class='form-control' placeholder='slide display[EN]' type='text'>
                </div>
				<div class='form-group'>
                  <label class='control-label'>简介[中文][可输入html标签]</label>
                  <textarea id="intro_cn"  class='form-control' rows='4'></textarea>
                </div>
				<div class='form-group'>
                  <label class='control-label'>Intro[EN]</label>
                  <textarea id="intro_en"  class='form-control' rows='4'></textarea>
                </div>
				<div class='form-group'>
                  <label class='control-label'>详细介绍[中文][可输入html标签]</label>
                  <textarea  id="detail_cn" class='form-control' rows='6'></textarea>
                </div>
				<div class='form-group'>
                  <label class='control-label'>Intro Detail[EN]</label>
                  <textarea  id="detail_en"  class='form-control' rows='6'></textarea>
                </div>
				<div class='form-group'>
                  <label class='control-label'>房产配套[中文][可输入html标签]</label>
                  <textarea   id="fac_cn" class='form-control' rows='4'></textarea>
                </div>
				<div class='form-group'>
                  <label class='control-label'>facilities[EN]</label>
                  <textarea  id="fac_en"  class='form-control' rows='4'></textarea>
                </div>
				<div class='form-group'>
                  <label class='control-label'>价格[AUD]</label>
                  <input   id="price"  class='form-control' placeholder='500000' type='text'>
                </div>
				<div class='form-group'>
                  <label class='control-label'>价格介绍[中文][可输入html标签]</label>
                  <textarea  id="price_cn"  class='form-control' rows='4'></textarea>
                </div>
				<div class='form-group'>
                  <label class='control-label'>Price Intro[EN]</label>
                  <textarea id="price_en"  class='form-control' rows='4'></textarea>
                </div>
				<div class="form-group">
					<label class='control-label'>主图片上传[只允许一张]</label>
                    <input id="file-3" type="file" multiple data-max-file-count="1">
					<label id="file-3-label" class='control-label'></label>
                </div>
				<div class="form-group">
					<label class='control-label'>房源图片[至少2张]</label>
                    <input id="file-1" type="file" multiple class="file" data-overwrite-initial="false" data-min-file-count="2">
					<label id="file-1-label" class='control-label'></label>
                </div>
				
				<div class="form-group">
					<label class='control-label'>户型图片[至少1张]</label>
                    <input id="file-2" type="file" multiple class="file" data-overwrite-initial="false" data-min-file-count="1">
					<label id="file-2-label" class='control-label'></label>
                </div>

              <div class='form-actions'>
                <button id="submited" class='btn btn-primary btn-lg' style="background-color:#448ECB" type='submit'>提交全部</button>
                <a class='btn' href='#'>Cancel</a>
              </div>
            
          </div>
        </div>
        

      </div>
    </div>
    <!-- Footer -->
    <!-- Javascripts -->

    <script src="./js/jquery.min.js" type="text/javascript"></script>
	<script src="./js/fileinput.min.js" type="text/javascript"></script>
    <script src="./js/fileinput_locale_zh.js" type="text/javascript"></script>
	<script src="//cdn.bootcss.com/jquery-ui-bootstrap/0.5pre/assets/js/jquery-ui-1.10.0.custom.min.js" type="text/javascript"></script>
	<script src="./js/modernizr.min.js" type="text/javascript"></script>
	<script src="assets/javascripts/application-985b892b.js" type="text/javascript"></script>
	<script type="text/javascript" src="./js/zeroModal.min.js" defer="" onload=""></script>
    <!-- Google Analytics -->
	
	<script>
	
	var url = "";
	
		$("#file-3").fileinput({
		showUpload: true,
		uploadUrl: 'http://localhost/realestate/fileUpload', 
		showCaption: false,
		browseClass: "btn btn-primary btn-lg",
		allowedFileExtensions : ['jpg', 'png','gif'],
        previewFileIcon: "<i class='glyphicon glyphicon-king'></i>"
	});
	    $("#file-1").fileinput({
		showUpload: true,
        uploadUrl: 'http://localhost/realestate/fileUpload', // you must set a valid URL here else you will get an error
        allowedFileExtensions : ['jpg', 'png','gif'],
        overwriteInitial: false,
        maxFileSize: 1000,
        maxFilesNum: 10,
        //allowedFileTypes: ['image', 'video', 'flash'],
        slugCallback: function(filename) {
            return filename.replace('(', '_').replace(']', '_');
        }
	});
		$("#file-2").fileinput({
		showUpload: true,
        uploadUrl: 'http://localhost/realestate/fileUpload', // you must set a valid URL here else you will get an error
        allowedFileExtensions : ['jpg', 'png','gif'],
        overwriteInitial: false,
        maxFileSize: 1000,
        maxFilesNum: 10,
        //allowedFileTypes: ['image', 'video', 'flash'],
        slugCallback: function(filename) {
//		alert(filename);
            return filename.replace('(', '_').replace(']', '_');
        }
	});
	
	$('#file-3').on('fileuploaded', function(event, data, previewId, index) {
		$("#file-3-label").append(data.files[0].name);
});
	$('#file-1').on('filebatchpreupload', function(event, data, previewId, index) {
	for(var key in data.files){
		$("#file-1-label").append(data.files[key].name+",");
	}
});
	$('#file-2').on('filebatchpreupload', function(event, data, previewId, index) {
	for(var key in data.files){
		$("#file-2-label").append(data.files[key].name+",");
	}
});

		    function _loading(type) {
			zeroModal.loading(type);
		}
		    function _success() {
			zeroModal.success('添加成功!');
		}

	$("#submited").on("click",function(){
		var type ="";
		$(":checkbox:checked").each(function(i, eleDom){
				type+=eleDom.value+",";
		});
		type=type.substring(0,type.length-1);

			$.post("posthouse",{
				name_cn: $("#name_cn").val(), 
				name_en: $("#name_cn").val(), 
				type_cn: type,
				sintro_cn: $("#sintro_cn").val(),
				sintro_en: $("#sintro_en").val(),
				intro_cn: $("#intro_cn").val(),
				intro_en: $("#intro_en").val(),
				detail_cn: $("#detail_cn").val(),
				detail_en: $("#detail_en").val(),
				fac_cn: $("#fac_cn").val(),
				fac_en: $("#fac_en").val(),
				price: $("#price").val(),
				price_cn: $("#price_cn").val(),
				price_en: $("#price_en").val(),
				img:$("#file-3-label").text(),
				img_d:$("#file-1-label").text().substring(0,$("#file-1-label").text().length-1),
				house_img:$("#file-2-label").text().substring(0,$("#file-2-label").text().length-1),
				}, function(data) {
					_loading(5);
				})
				.success(function() {  })
				.error(function() {  })
				.complete(function() { 
				zeroModal.closeAll();
				_success();});

	});
	
	</script>
  </body>
</html>
